appId: com.moboudra.paseo
---
- launchApp:
    clearState: true
- runFlow: flows/launch.yaml

- tapOn: "Paste pairing link"
- eraseText
- inputText: ${PAIRING_OFFER_URL}
- tapOn:
    point: "75%,36%"

- extendedWaitUntil:
    visible: "New agent"
    timeout: 20000

# Open settings and ensure we're connected (initially via relay).
- tapOn:
    point: "8%,6%"
- extendedWaitUntil:
    visible:
      id: "sidebar-voice"
    timeout: 10000
- tapOn:
    point: "92%,94%"
- extendedWaitUntil:
    visible: "Settings"
    timeout: 20000

- extendedWaitUntil:
    visible: "Connected via relay"
    timeout: 20000

# Add a direct connection and ensure we prefer it when available.
- tapOn: "Edit"
- extendedWaitUntil:
    visible: "Edit host"
    timeout: 10000

- tapOn:
    text: "192.168.1.10:6767"
- eraseText
- inputText: ${DIRECT_ENDPOINT}
- tapOn: "Add"
- tapOn: "Save"

- extendedWaitUntil:
    visible: "Connected via ${DIRECT_ENDPOINT}"
    timeout: 30000
